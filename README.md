# 像素大战前端项目

一个基于 **Vite + React + TypeScript + TailwindCSS + Zustand** 的高性能像素大战前端，实现离线像素大战玩法，并为后续实时联机预留扩展能力。

## 快速开始

```bash
npm install
npm run dev
```

浏览器访问终端输出的地址（默认 http://localhost:5173 或 http://localhost:5174）即可体验开发环境。

常用脚本：

| 脚本 | 功能 |
| --- | --- |
| `npm run dev` | 启动开发服务器（热更新） |
| `npm run build` | 构建生产包 |
| `npm run preview` | 预览构建产物 |
| `npm run lint` | 运行 ESLint |

## 核心技术栈

- **Vite 7**：极速构建与开发体验
- **React 19 + TypeScript**：现代组件化与类型安全
- **TailwindCSS**：原子化样式快速搭建 UI
- **Zustand**：轻量状态管理，集中维护画布、工具与持久化
- **Canvas 2D**：离屏画布 + 脏区重绘，兼顾大尺寸画布性能

## 已实现功能

- 1024×1024 像素网格，32 色调色板
- 像素放置冷却、撤销、Alt 吸管、Ctrl+Z 快捷键
- 本地持久化（`localStorage`），导出 PNG、导入/导出 JSON
- 迷你地图定位、HUD 显示缩放与冷却状态
- 可选网格叠加（侧栏开关）
- 局部脏区重绘 + 可见区域裁剪
- 桌面端：左键放置、右键拖拽、滚轮缩放
- 移动端：单指拖拽、双指缩放、轻触落点

## 操作说明

- 侧边栏「工具」区域提供「画笔 (B)」与「选框 (M)」按钮，或使用键盘快捷键切换当前工具，HUD 会同步显示状态。
- 在选框模式下，可通过侧栏按钮或快捷键 `F` 填充当前选区，使用按钮或 `Esc` 取消选择。
- 仍可使用既有操作：左键放置像素、右键拖动画布、滚轮缩放、按住 `Alt` 吸管取色、`Ctrl+Z` 撤销。

## 项目结构

```
pixel/
├─ public/
├─ src/
│  ├─ components/    # 画布、迷你地图、工具栏等 UI 组件
│  ├─ store/         # Zustand 像素状态与持久化逻辑
│  ├─ assets/
│  ├─ App.tsx        # 页面框架
│  ├─ main.tsx       # 应用入口
│  └─ index.css      # Tailwind 初始化样式
├─ package.json
└─ README.md
```

## 后续开发路线

> 以下路线按主题分组，可根据优先级灵活推进。建议先聚焦「性能 & 体验」，再扩展「联机」与「工程化」。

### 性能 & 体验

1. **全量重绘优化**：调色板更新或载入全量数据时，改用 `ImageData` 批量写入以进一步降低延迟。
2. **移动端交互增强**：支持双击缩放、长按吸管、拖拽阻尼等手势细节。
3. **网格与光标自定义**：允许设置网格颜色/透明度/显示阈值，并在冷却、吸管状态下提供光标提示。

### 功能拓展

1. **可变画布尺寸**：开放 2048×2048 或更大网格，并优化迷你地图与缩略导航体验。
2. **多选与填充工具**：实现矩形/套索选择、区域填充、撤销步数上限配置。
3. **导出与分享**：生成包含画布快照的分享链接或压缩数据，便于协作或留档。

### 联机扩展预留

1. **WebSocket 适配层**：抽象 `sendPlacePixel` / `applyRemotePixels`，解耦前端与实时后端。
2. **同步策略**：设计服务端权威、冷却校验与延迟补偿机制。
3. **观战模式**：提供只读视角实时观看全局变化。

### 工程化 & 质量

1. **文档与指南**：持续完善 README、贡献说明与开发约定。
2. **自动化测试**：覆盖像素编码/解码、持久化、渲染辅助函数等核心逻辑。
3. **性能压测**：在 CI 中加入离屏渲染与交互基准测试，监控性能回归。

### 可访问性 & 国际化

1. **键盘导航**：支持 WASD/方向键移动视图与颜色切换快捷键。
2. **高对比度主题**：提供深浅色、高对比度方案，并完善 ARIA 标签。
3. **多语言支持**：抽离文案，支持中文/英文（及更多语言）切换。

---

如需调整画布尺寸、颜色数量或冷却时间，可在 `src/store/usePixelStore.ts` 中修改默认参数。
